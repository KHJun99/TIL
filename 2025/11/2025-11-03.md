# 2025-11-03 TIL

# ✅ 오늘 한 일
- 데이터베이스의 개념과 등장 배경 학습
- 관계형 데이터베이스(RDB)의 구조와 테이블 간의 관계 이해
- SQL의 기본 구조와 문법 학습
- SELECT, FROM, WHERE, ORDER BY를 활용한 데이터 조회 실습
- DISTINCT, LIMIT, LIKE 등 데이터 필터링 키워드 학습
- GROUP BY와 HAVING을 활용한 집계 데이터 조회
- SQL 실행 순서 이해 및 각 절의 역할 구분

# 📚 배운 점
- **데이터베이스의 중요성**: 전 세계 데이터의 90%가 2015년 이후 생산되었으며, 네이버와 카카오는 데이터센터에 수조 원을 투자할 정도로 데이터 관리 기술이 중요
- **관계형 데이터베이스**: 데이터를 테이블 형태로 저장하고 테이블 간의 관계를 통해 효율적으로 관리
- **Primary Key**: 각 레코드를 고유하게 식별하는 값으로, 중복 불가하며 NULL 값을 가질 수 없음
- **Foreign Key**: 다른 테이블의 Primary Key를 참조하여 테이블 간의 관계를 형성
- **SQL의 3가지 유형**: DDL(데이터 정의), DML(데이터 조작), DCL(데이터 제어)
- **WHERE vs HAVING**: WHERE는 그룹화 전 개별 행에, HAVING은 그룹화 후 그룹에 조건 적용
- **SQL 실행 순서**: FROM → WHERE → GROUP BY → HAVING → SELECT → ORDER BY → LIMIT

# 📌 핵심 개념
- **RDBMS**: 관계형 데이터베이스를 관리하는 소프트웨어 시스템 (MySQL, PostgreSQL, Oracle, SQLite 등)
- **테이블 구성 요소**: Field/Column(열), Record/Row(행)
- **DISTINCT**: SELECT 바로 뒤에 작성하여 중복 제거
- **LIKE 와일드카드**: `%` (0개 이상의 문자), `_` (정확히 1개의 문자)
- **집계 함수**: COUNT(), SUM(), AVG(), MAX(), MIN()
- **NULL 처리**: 일반 비교 연산자 사용 불가, IS NULL 또는 IS NOT NULL 사용 필요
- **LIMIT 활용**: 결과 개수 제한 및 페이지네이션 구현 (OFFSET 사용)

# 💡 예시 코드

**기본 SELECT 문**
```sql
-- 모든 컬럼 조회
SELECT *
FROM employees;

-- 특정 컬럼만 조회
SELECT
    FirstName, LastName
FROM
    employees;

-- 별칭(Alias) 사용
SELECT
    FirstName AS '이름',
    LastName AS '성'
FROM
    employees;
```

**ORDER BY - 정렬**
```sql
-- 오름차순 정렬 (기본값)
SELECT
    FirstName
FROM
    employees
ORDER BY
    FirstName ASC;

-- 내림차순 정렬
SELECT
    FirstName
FROM
    employees
ORDER BY
    FirstName DESC;

-- 여러 컬럼 기준 정렬
SELECT
    Country, City
FROM
    customers
ORDER BY
    Country ASC,
    City DESC;
```

**DISTINCT - 중복 제거**
```sql
-- 중복되지 않는 국가 목록만 조회
SELECT DISTINCT
    Country
FROM
    customers;
```

**WHERE - 조건 필터링**
```sql
-- 같은 값 찾기
SELECT
    LastName, FirstName, City
FROM
    customers
WHERE
    City = 'Prague';

-- OR 조건
SELECT
    LastName, FirstName, Country
FROM
    customers
WHERE
    Country = 'Canada'
    OR Country = 'Germany'
    OR Country = 'France';

-- AND 조건
SELECT
    LastName, FirstName, Country
FROM
    customers
WHERE
    Country = 'USA'
    AND City = 'New York';
```

**LIKE - 패턴 매칭**
```sql
-- '김'으로 시작하는 이름
SELECT *
FROM customers
WHERE name LIKE '김%';

-- '이'로 끝나는 이름
SELECT *
FROM customers
WHERE name LIKE '%이';

-- '영'이 포함된 이름
SELECT *
FROM customers
WHERE name LIKE '%영%';

-- 두 번째 글자가 '영'인 이름
SELECT *
FROM customers
WHERE name LIKE '_영%';
```

**범위 연산자**
```sql
-- BETWEEN
SELECT *
FROM products
WHERE price BETWEEN 1000 AND 5000;

-- IN
SELECT *
FROM customers
WHERE country IN ('Korea', 'Japan', 'China');
```

**LIMIT - 결과 개수 제한**
```sql
-- 상위 5개만 조회
SELECT *
FROM employees
ORDER BY salary DESC
LIMIT 5;

-- 6번째부터 10개 조회 (페이지네이션)
SELECT *
FROM employees
LIMIT 5, 10;  -- OFFSET 5, LIMIT 10
```

**GROUP BY - 그룹화**
```sql
-- 국가별 고객 수
SELECT
    Country,
    COUNT(*) AS '고객수'
FROM
    customers
GROUP BY
    Country;

-- 제품 카테고리별 평균 가격
SELECT
    category,
    AVG(price) AS '평균가격'
FROM
    products
GROUP BY
    category;
```

**HAVING - 그룹 조건**
```sql
-- 고객 수가 5명 이상인 국가만 조회
SELECT
    Country,
    COUNT(*) AS '고객수'
FROM
    customers
GROUP BY
    Country
HAVING
    COUNT(*) >= 5;

-- 평균 급여가 5000 이상인 부서만 조회
SELECT
    department,
    AVG(salary) AS '평균급여'
FROM
    employees
GROUP BY
    department
HAVING
    AVG(salary) >= 5000;
```

**종합 예시 - SQL 실행 순서 이해**
```sql
SELECT
    Country, COUNT(*) AS customer_count
FROM
    customers
WHERE
    City != 'Seoul'
GROUP BY
    Country
HAVING
    COUNT(*) >= 3
ORDER BY
    customer_count DESC
LIMIT 10;

-- 실행 순서:
-- 1. FROM customers
-- 2. WHERE City != 'Seoul'
-- 3. GROUP BY Country
-- 4. HAVING COUNT(*) >= 3
-- 5. SELECT Country, COUNT(*)
-- 6. ORDER BY customer_count DESC
-- 7. LIMIT 10
```

**NULL 처리**
```sql
-- ❌ 잘못된 방법
SELECT *
FROM employees
WHERE manager_id = NULL;

-- ✅ 올바른 방법
SELECT *
FROM employees
WHERE manager_id IS NULL;

SELECT *
FROM employees
WHERE manager_id IS NOT NULL;
```

# 🛠️ 이슈 & 해결
| 🐞 문제 상황 | 🔍 원인 | 💡 해결 방법 |
|--------------|--------|--------------|
| NULL 값을 `=` 연산자로 비교했을 때 결과가 나오지 않음 | NULL은 '값이 없음'을 의미하여 일반 비교 연산자 사용 불가 | `IS NULL` 또는 `IS NOT NULL` 사용 |
| WHERE 절에서 집계 함수를 사용했을 때 에러 발생 | WHERE는 그룹화 전에 실행되어 집계 함수 사용 불가 | 집계 함수는 HAVING 절에서 사용 |
| DISTINCT를 여러 컬럼에 사용했을 때 예상과 다른 결과 | DISTINCT는 선택한 컬럼들의 조합이 고유한 행만 반환 | 필요한 경우 GROUP BY 사용 고려 |
| ORDER BY가 GROUP BY보다 먼저 실행될 것으로 예상 | SQL 실행 순서에 대한 오해 | SQL 실행 순서: FROM → WHERE → GROUP BY → HAVING → SELECT → ORDER BY → LIMIT 순서 숙지 |